<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seznam zaměstnanců - CRC</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        .zam-table { width: 100%; max-width: 600px; margin: 2em auto; border-collapse: separate; border-spacing: 0 0.5em; }
        .zam-row { background: #fffbe6; border-radius: 8px; box-shadow: 0 2px 8px #bfa14a22; transition: box-shadow 0.2s; cursor:pointer; }
        .zam-row:hover { box-shadow: 0 4px 16px #bfa14a55; }
        .zam-cell { padding: 1em 1.2em; font-size: 1.1em; }
        .zam-status { font-weight: bold; }
        .zam-status.volno { color: #bfa14a; }
        .zam-status.vpraci { color: #2ecc71; }
        .zam-dot { display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:0.5em; vertical-align:middle; }
        .zam-dot.volno { background:#bfa14a; }
        .zam-dot.vpraci { background:#2ecc71; }
        .zam-trasa { font-size:0.95em; color:#888; }
    </style>
</head>
<body>
    <div class="book-page">
        <div class="border-decoration">
            <header class="main-title">
                <h1>Seznam zaměstnanců</h1>
                <a href="index.html" class="back-link">← Zpět</a>
            </header>
            <div id="zamestnanci-list"></div>
        </div>
    </div>
    <script type="module">
      import { db } from './firebase.js';
      import { collection, onSnapshot } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
      function renderZamestnanci(snap) {
        let html = `<table class='zam-table'>`;
        snap.forEach(doc => {
          const d = doc.data();
          html += `<tr class='zam-row' onclick="window.location.href='zamestnanec.html?id=${doc.id}'">
            <td class='zam-cell'><span class='zam-dot ${d.status==='v praci'?'vpraci':'volno'}'></span>${d.jmeno}</td>
            <td class='zam-cell zam-status ${d.status==='v praci'?'vpraci':'volno'}'>${d.status==='v praci'?'V práci':'Volno'}</td>
            <td class='zam-cell zam-trasa'>${d.aktualniTrasa||'-'}${d.lokomotiva ? ` <span style='color:#bfa14a;font-size:0.95em;'>(Lokomotiva: ${d.lokomotiva})</span>` : ''}</td>
          </tr>`;
        });
        html += `</table>`;
        document.getElementById('zamestnanci-list').innerHTML = html;
      }
      const col = collection(db, "zamestnanci");
      onSnapshot(col, renderZamestnanci);
    </script>
</body>
</html>
